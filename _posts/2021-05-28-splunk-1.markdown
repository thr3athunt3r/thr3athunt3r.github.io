---
layout: post
title:  "How To Collect Windows Event Logs to Splunk \"AGENTLESS-LY\""
date:   2021-05-28 01:40:24 +0800
categories: splunk
---

#### Have you ever wonder to forward windows event logs to a Splunk instance without need of mass deploying [universal forwarder](https://docs.splunk.com/Splexicon:Universalforwarder) on every single host? This might be a solution for you! What we're gonna do is centralize all the logs first with [Windows Event Collector](https://docs.microsoft.com/en-us/windows/win32/wec/windows-event-collector), then forward them with just a universal forwarder which will also be installed on the same server. So, let's get started.

### Prerequisite:
1. **Windows Event Forwarding Server**
    - Windows Server 2012 and above (or Windows 10, extra configuration is required)
    - 16GB of RAM or more for 2000 clients
    - CPU with 4 or more core for 2000 clients
    - Log size for each client is about 700MB per day with advanced audit configured (log ingested to Splunk won't be so big)
    - SSD is recommended
    <br><br>
2. **Client(s)**
    - Windows 7 and above (lower versions are not tested)
    - Windows Server 2012 and above (lower versions are not tested)
    <br><br>

### First: Setup Source Initiated Subscription for Windows Event Forwarding
1. **Configure GPO**
    - Enable Advanced Audit Policy Configuration
    - Allow `network access` to Security Events on all clients
    - Enable WinRM on both WEF server and clients (ensure WinRM is set up in best practice)
    - Enable event forwarding subscription for all clients
    <br><br>
2. **Create a Windows Event Forwarding Subscription**
    <br><br>

{% highlight ruby %}
Coming Soon!
{% endhighlight %}
